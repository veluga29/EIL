## 로그인 기본 비즈니스 로직
- 로그인 컨트롤러
	- 로그인 서비스 로직 호출
		- 호출 성공하면 정상 리턴
		- 실패 시, 글로벌 오류 생성
- 로그인 서비스 로직
	- 회원을 조회
	- 파라미터로 넘어온 password와 비교
		- password가 같으면 회원을 반환
		- 다르면 `null` 을 반환
## 로그인 유지 방법
- e.g. 로그인 성공한 고객의 이름을 보여주기
- 쿠키 방식
	- 서버에서 로그인 성공 시 HTTP 응답에 쿠키를 담아 브라우저에 전달 (`Set-Cookie`)
	- 브라우저는 앞으로 모든 요청에 쿠키 정보 자동 포함
	- 쿠키 종류
		- 영속 쿠키: 만료 날짜를 **입력**하면 **해당 날짜까지 유지**
		- 세션 쿠키: 만료 날짜를 **생략**하면 **브라우저 종료시까지만 유지**
	- 쿠키 생성 로직
		```java
		//쿠키에 시간 정보를 주지 않으면 세션 쿠키(브라우저 종료시 모두 종료)
		Cookie idCookie = new Cookie("memberId", String.valueOf(loginMember.getId()));
		response.addCookie(idCookie); //response: HttpServletResponse
		```
	- 쿠키 조회 파라미터
		- `@CookieValue(name = "memberId", required = false) Long memberId`
		- `required = false`: 로그인 하지 않은 사용자도 접근 허용
	- 쿠키 로그아웃 로직
		```java
		Cookie cookie = new Cookie(cookieName, null);
		cookie.setMaxAge(0);
		response.addCookie(cookie); //response: HttpServletResponse
		```
		- 응답 쿠키를 `Max-Age=0`로 생성해, 기존 쿠키를 덮어 씌우고 즉시 종료되게끔 함
	- 보안 문제
		- 쿠키 값은 **임의로 변경** 가능
			- 클라이언트에서 마음대로 변경 가능
			- e.g. `Cookie: memberId=1` `Cookie: memberId=2` (다른사용자의 이름이 보임)
		- 쿠키에 보관된 정보는 **훔칠 수 있음**
			- 쿠키에 개인 정보나, 신용카드 정보가 있다면...
			- 해당 정보가 **브라우저에도 보관**되고, **네트워크 요청마다** 계속 클라이언트에서 서버로 전달
			- 나의 **로컬 PC**에서 털릴 수도 있고, **네트워크 전송 구간**에서 털릴 수도 있음
		- 해커가 쿠키를 **한 번 훔쳐가면 평생 사용 가능**
			- 해커가 악의적인 요청 계속 시도 가능
	- 보안 문제 대안
		- 쿠키에 **예측 불가능한 임의의 토큰(랜덤 값)을 노출**
			- 토큰은 해커가 임의의 값을 넣어도 찾을 수 없도록 예상 불가능해야 함
			- 클라이언트와 서버의 연결은 추정 불가능한 임의의 식별자 값으로 연결해야 함
		- **서버에서 토큰을 관리**
			- **중요한 값을 서버에 보관하고 노출하지 않음**
			- 서버에서 토큰과 사용자 id를 매핑해서 인식
		- **서버**에서 해당 **토큰의 만료시간을 짧게 유지** (예: 30분)
			- 해커가 토큰을 털어가도 시간이 지나면 사용할 수 없음
			- **해킹이 의심**되는 경우 **서버**에서 **해당 토큰을 강제로 제거**
- 세션 방식
	- **서버에 중요한 정보를 보관**하고 **연결을 유지**하는 방법
	- 서버는 **세션 저장소**를 가짐
		- 단순하게는 **`Map<sessionId, value>`** 형태
		- 세션 ID는 **추정 불가능** 해야 하므로 **UUID를 주로 사용**
	- 동작 방식
		- 로그인
			- 사용자가 `loginId` , `password` 정보를 전달하면 **서버에서 해당 사용자가 맞는지 확인**
			- 서버는 **세션 ID를 생성**하고, 보관할 **값**과 함께 **세션 저장소에 보관**
			- 서버는 클라이언트에게 **세션 ID만 쿠키로 전달** (`Set-Cookie`)
				- **중요한 정보**는 **서버**에 있음
				- 추정불가능한 세션 ID만 클라이언트에 전달되므로 **사용자 추정 불가**
			- 클라이언트는 **쿠키 저장소**에 세션 ID가 담긴 쿠키를 **저장**
		- 로그인 이후
			- 클라이언트는 요청시 항상 서버로 쿠키를 전달
			- 서버는 전달 받은 쿠키 정보로 **세션 저장소를 조회**해서 **로그인시 보관한 세션 정보를 사용**
	- 세션 방식은 단순 쿠키 방식의 **보안 문제들을 해결**
		- **예상 불가능한 세션 ID**를 사용해 쿠키값 변조를 예방
		- **쿠키 정보(세션 ID)가 털려도** 여기에는 **중요한 정보가 없음** (서버에 있음)
		- 세션 만료시간을 **짧게** 유지하고, 해킹 의심시 서버에서 **해당 세션 강제 제거**
